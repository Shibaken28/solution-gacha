name: Deploy to GitHub Pages

on:
  push:
    branches:
      - main # mainãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸã¨ãã«å®Ÿè¡Œ (é©å®œå¤‰æ›´ã—ã¦ãã ã•ã„)

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä½¿ç”¨ã—ã¦ã„ã‚‹Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«åˆã‚ã›ã¦ãã ã•ã„
          cache: 'npm'

      - name: Install dependencies
        run: npm ci # package-lock.json ãŒã‚ã‚Œã° npm ciã€ãªã‘ã‚Œã° npm install

      - name: Build project
        run: npm run build # ğŸ¯ package.json ã® scripts ã«å®šç¾©ã•ã‚ŒãŸãƒ“ãƒ«ãƒ‰ã‚³ãƒãƒ³ãƒ‰
        env:
          # ğŸ¯ GitHub PagesãŒãƒªãƒã‚¸ãƒˆãƒªåã®ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãªã‚‹å ´åˆã€
          #    ãƒ“ãƒ«ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ã§ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹ã®æŒ‡å®šãŒå¿…è¦ãªã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
          #    ä¾‹: BASE_URL: /${{ github.event.repository.name }}/
          #    ã“ã®ç’°å¢ƒå¤‰æ•°ã‚’ãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚„è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« (ä¾‹: Webpackã®publicPath) ã§
          #    åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
          #    ã‚‚ã—ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ« (Webpack, Rollup, Parcelãªã©) ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€
          #    ãã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§å‡ºåŠ›ãƒ‘ã‚¹ã‚’èª¿æ•´ã™ã‚‹ã“ã¨ãŒä¸€èˆ¬çš„ã§ã™ã€‚

      - name: Setup Pages
        uses: actions/configure-pages@v5

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          # ğŸ¯ ãƒ“ãƒ«ãƒ‰æˆæœç‰©ãŒå‡ºåŠ›ã•ã‚Œã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã‚’æŒ‡å®šã—ã¦ãã ã•ã„
          path: ./dist # ä¾‹: ./public, ./build, ./app ãªã©

      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4